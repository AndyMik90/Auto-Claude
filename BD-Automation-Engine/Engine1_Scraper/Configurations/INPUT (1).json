{"browserLog":false,"closeCookieModals":false,"debugLog":false,"downloadCss":true,"downloadMedia":true,"globs":[{"glob":"https://www.apexsystems.com/job/*/*"}],"headless":true,"ignoreCorsAndCsp":false,"ignoreSslErrors":false,"keepUrlFragments":false,"linkSelector":"a","maxConcurrency":3,"maxCrawlingDepth":2,"maxPagesPerCrawl":0,"maxRequestRetries":5,"maxResultsPerCrawl":0,"maxScrollHeightPixels":5000,"pageFunction":"async function pageFunction(context) {\n    const { page, request, log, enqueueLinks } = context;\n    \n    // Handle search results / listing pages\n    if (!request.url.includes('/job/')) {\n        log.info(`Listing page: ${request.url}`);\n        await new Promise(r => setTimeout(r, 3000));\n        \n        // Count jobs on this page\n        const jobCount = await page.evaluate(() => {\n            const jobLinks = document.querySelectorAll('a[href*=\"/job/\"]');\n            return jobLinks.length;\n        });\n        log.info(`Found ${jobCount} job links on this page`);\n        \n        // Check if there's a next page and enqueue it\n        const currentUrl = new URL(request.url);\n        const currentPage = parseInt(currentUrl.searchParams.get('page') || '1');\n        \n        // If we found 25+ jobs on this page, there's likely another page\n        // Less than 25 means this is the last page\n        if (jobCount >= 25) {\n            const nextPage = currentPage + 1;\n            const nextUrl = new URL(request.url);\n            nextUrl.searchParams.set('page', nextPage.toString());\n            \n            log.info(`Full page found (${jobCount} jobs). Enqueueing next page: ${nextUrl.toString()}`);\n            await enqueueLinks({\n                urls: [nextUrl.toString()],\n                label: 'listing'\n            });\n        } else {\n            log.info(`Last page reached (${jobCount} jobs < 25). Stopping pagination at page ${currentPage}`);\n        }\n        \n        return null;\n    }\n    \n    // Handle individual job pages\n    log.info(`Extracting job: ${request.url}`);\n    await new Promise(r => setTimeout(r, 2000));\n    \n    const jobData = await page.evaluate(() => {\n        const result = {};\n        \n        // Helper to decode HTML entities\n        const decodeHtml = (html) => {\n            const txt = document.createElement('textarea');\n            txt.innerHTML = html;\n            return txt.value;\n        };\n        \n        // Extract from JSON-LD structured data\n        const jsonLdScript = document.querySelector('script[type=\"application/ld+json\"]');\n        if (jsonLdScript) {\n            try {\n                const jsonLd = JSON.parse(jsonLdScript.textContent);\n                if (jsonLd['@type'] === 'JobPosting') {\n                    result.jobTitle = jsonLd.title || null;\n                    \n                    // Clean description - only remove EEO boilerplate at the END\n                    let desc = jsonLd.description || '';\n                    \n                    // Decode HTML entities\n                    desc = decodeHtml(desc);\n                    \n                    // Remove EEO boilerplate (only at the end)\n                    const eeoIndex = desc.indexOf('EEO Employer');\n                    if (eeoIndex > 0) {\n                        desc = desc.substring(0, eeoIndex);\n                    }\n                    const eeoIndex2 = desc.indexOf('Apex Systems is an equal opportunity employer');\n                    if (eeoIndex2 > 0) {\n                        desc = desc.substring(0, eeoIndex2);\n                    }\n                    \n                    // Remove recruiter intro ONLY if it's at the very beginning\n                    desc = desc.replace(/^Apex Systems is a world class[^]*?Here are the details:\\s*/i, '');\n                    \n                    // Remove single-line recruiter contact sentences\n                    desc = desc.replace(/^To apply,? email [^\\n]{0,50}@apexsystems\\.com[^\\n]*\\n?/i, '');\n                    desc = desc.replace(/^For applicants[^\\n]{0,100}@apexsystems\\.com[^\\n]*\\n?/i, '');\n                    \n                    result.description = desc.trim();\n                    \n                    result.employmentType = jsonLd.employmentType || null;\n                    result.datePosted = jsonLd.datePosted || null;\n                    if (jsonLd.identifier && jsonLd.identifier.value) {\n                        result.jobNumber = String(jsonLd.identifier.value);\n                    }\n                    if (jsonLd.jobLocation && jsonLd.jobLocation.address) {\n                        const addr = jsonLd.jobLocation.address;\n                        result.location = [addr.addressLocality, addr.addressRegion].filter(Boolean).join(', ');\n                    }\n                }\n            } catch (e) { }\n        }\n        \n        // Get additional fields from body text\n        const bodyText = document.body.innerText;\n        \n        const extractField = (patterns) => {\n            for (const pattern of patterns) {\n                const match = bodyText.match(pattern);\n                if (match) return match[1].trim().split('\\n')[0];\n            }\n            return null;\n        };\n        \n        // Security clearance - multiple patterns\n        result.securityClearance = extractField([\n            /Security Clearance:\\s*([^\\n]{5,80})/i,\n            /Clearance requirement:\\s*([^\\n]{5,80})/i,\n            /Clearance[^:]*:\\s*((?:Active\\s+)?(?:TS\\/SCI|Top Secret|Secret|Public Trust)[^\\n]{0,60})/i,\n            /((?:Top Secret|TS\\/SCI|Secret)\\s+clearance[^\\n]{0,40}(?:required|preferred|acceptable)[^\\n]{0,30})/i,\n            /((?:Active|Current)\\s+(?:Top Secret|TS\\/SCI|Secret)[^\\n]{0,40})/i\n        ]);\n        \n        // Pay rate - look for various patterns\n        result.payRate = extractField([\n            /Pay Rate:\\s*([^\\n]+)/i, \n            /Rate:\\s*(\\$[^\\n]+|Negotiable[^\\n]*)/i,\n            /Pay:\\s*(\\$[^\\n]+)/i,\n            /Base Salary[:\\s]*(\\$?[\\d,]+-?[\\d,]*(?:k|K)?)/i,\n            /Salary[:\\s]*(\\$?[\\d,]+-?[\\d,]*(?:k|K)?)/i\n        ]);\n        \n        // Duration\n        result.duration = extractField([\n            /Project Duration:\\s*([^\\n]+)/i, \n            /Duration:\\s*([^\\n]+)/i, \n            /Contract Length:\\s*([^\\n]+)/i\n        ]);\n        \n        return result;\n    });\n    \n    return { url: request.url, ...jobData, scrapedAt: new Date().toISOString() };\n}","pageFunctionTimeoutSecs":120,"pageLoadTimeoutSecs":120,"proxyConfiguration":{"useApifyProxy":true,"apifyProxyGroups":["RESIDENTIAL"]},"proxyRotation":"RECOMMENDED","respectRobotsTxtFile":false,"startUrls":[{"url":"https://www.apexsystems.com/search-results-usa?catalogcode=USA&address=&radius=50&page=1&rows=25&query=Clearance%20&remote="}],"useChrome":true,"waitUntil":["domcontentloaded"],"pseudoUrls":[],"excludes":[],"initialCookies":[],"customData":{}}