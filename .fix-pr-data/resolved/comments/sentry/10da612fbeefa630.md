# Comment: 10da612fbeefa630

**Source:** sentry
**Type:** comment
**File:** `apps/backend/agents/linear_validator.py`
**Original ID:** 2735016982
**Created:** None
**Severity:** HIGH
**Status:** SKIPPED

---

## Original Content

**Bug:** The backend `_fetch_linear_issue` function always prefixes the Linear API key with `Bearer `, causing authentication to fail for personal API keys (`lin_api_...`).
<sub>Severity: HIGH</sub>
<!-- BUG_PREDICTION -->

<details>
<summary><b title="Reference ID: `9308848`">Suggested Fix</b></summary>

Update `_fetch_linear_issue` in `linear_validator.py` and other affected backend files (`updater.py`, `client.py`) to conditionally add the `Bearer ` prefix. The prefix should only be added if the API key does not start with `lin_api_`, mirroring the logic already implemented in the frontend.
</details>

<details open>
<summary><b title="Reference ID: `9308848`">Prompt for AI Agent</b></summary>

```
Review the code at the location below. A potential bug has been identified by an AI
agent.
Verify if this is a real issue. If it is, propose a fix; if not, explain why it's not
valid.

Location: apps/backend/agents/linear_validator.py#L514-L517

Potential issue: The `_fetch_linear_issue` method in `linear_validator.py`
unconditionally adds a `Bearer ` prefix to the `Authorization` header. This is incorrect
for personal Linear API keys, which start with `lin_api_` and should not have the
prefix, as per Linear's API documentation. The frontend correctly handles this logic,
but the backend does not. When the ticket validation process is triggered without
pre-fetched issue data, it calls this function, causing authentication to fail for any
user configured with a personal API key. This will break the ticket validation feature
for those users.
```
</details>

<!--
<sub>Reference ID: `9308848`</sub>-->

---

## Suggested Fix

```python
Review the code at the location below. A potential bug has been identified by an AI
agent.
Verify if this is a real issue. If it is, propose a fix; if not, explain why it's not
valid.

Location: apps/backend/agents/linear_validator.py#L514-L517

Potential issue: The `_fetch_linear_issue` method in `linear_validator.py`
unconditionally adds a `Bearer ` prefix to the `Authorization` header. This is incorrect
for personal Linear API keys, which start with `lin_api_` and should not have the
prefix, as per Linear's API documentation. The frontend correctly handles this logic,
but the backend does not. When the ticket validation process is triggered without
pre-fetched issue data, it calls this function, causing authentication to fail for any
user configured with a personal API key. This will break the ticket validation feature
for those users.
```

---

## Implementation Notes

*Status: SKIPPED*

**Resolution:** Already fixed or false positive