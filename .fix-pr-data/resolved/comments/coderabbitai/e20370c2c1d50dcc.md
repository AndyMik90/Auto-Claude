# Comment: e20370c2c1d50dcc

**Source:** coderabbitai
**Type:** comment
**File:** `apps/frontend/src/renderer/components/Sidebar.tsx`
**Line:** 188
**Original ID:** 2733978875
**Created:** None
**Severity:** HIGH
**Status:** RESOLVED

---

## Original Content

_âš ï¸ Potential issue_ | _ğŸŸ  Major_

<details>
<summary>ğŸ§© Analysis chain</summary>

ğŸ Script executed:

```shell
cat -n apps/frontend/src/renderer/components/Sidebar.tsx | sed -n '120,180p'
```

Repository: AndyMik90/Auto-Claude

Length of output: 2542

---

ğŸ Script executed:

```shell
head -50 apps/frontend/src/renderer/components/Sidebar.tsx
```

Repository: AndyMik90/Auto-Claude

Length of output: 1039

---

ğŸ Script executed:

```shell
cat apps/frontend/src/renderer/components/Sidebar.tsx | grep -n "'" | head -30
```

Repository: AndyMik90/Auto-Claude

Length of output: 2256

---

ğŸ Script executed:

```shell
cat apps/frontend/src/renderer/components/Sidebar.tsx | grep -n '"' | head -30
```

Repository: AndyMik90/Auto-Claude

Length of output: 2123

---

ğŸ Script executed:

```shell
wc -l apps/frontend/src/renderer/components/Sidebar.tsx
```

Repository: AndyMik90/Auto-Claude

Length of output: 118

---

ğŸ Script executed:

```shell
sed -n '340,430p' apps/frontend/src/renderer/components/Sidebar.tsx
```

Repository: AndyMik90/Auto-Claude

Length of output: 3284

---

ğŸ Script executed:

```shell
rg "Auto Claude|Settings|Project" apps/frontend/src/renderer/components/Sidebar.tsx -n
```

Repository: AndyMik90/Auto-Claude

Length of output: 2923

---

ğŸ Script executed:

```shell
sed -n '50,60p' apps/frontend/src/renderer/components/Sidebar.tsx
```

Repository: AndyMik90/Auto-Claude

Length of output: 529

---

ğŸ Script executed:

```shell
rg "useProjectEnvStore\|envConfig" apps/frontend/src/renderer/components/Sidebar.tsx -n
```

Repository: AndyMik90/Auto-Claude

Length of output: 47

---

ğŸ Script executed:

```shell
sed -n '126,176p' apps/frontend/src/renderer/components/Sidebar.tsx
```

Repository: AndyMik90/Auto-Claude

Length of output: 1550

---

ğŸ Script executed:

```shell
grep -n "envConfig\|useProjectEnvStore\|loadProjectEnvConfig" apps/frontend/src/renderer/components/Sidebar.tsx
```

Repository: AndyMik90/Auto-Claude

Length of output: 377

---

ğŸ Script executed:

```shell
sed -n '350,360p' apps/frontend/src/renderer/components/Sidebar.tsx
```

Repository: AndyMik90/Auto-Claude

Length of output: 384

---

ğŸ Script executed:

```shell
grep -n "Auto Claude\|Help\|New Project\|New Task" apps/frontend/src/renderer/components/Sidebar.tsx
```

Repository: AndyMik90/Auto-Claude

Length of output: 438

---

ğŸ Script executed:

```shell
find apps/frontend -name "*.json" -path "*/en/*" -o -path "*/fr/*" | head -20
```

Repository: AndyMik90/Auto-Claude

Length of output: 1154

---

ğŸ Script executed:

```shell
grep -r "Auto Claude\|appName" apps/frontend/src/locales/ 2>/dev/null | head -20
```

Repository: AndyMik90/Auto-Claude

Length of output: 47

---

ğŸ Script executed:

```shell
cat apps/frontend/src/shared/i18n/locales/en/common.json
```

Repository: AndyMik90/Auto-Claude

Length of output: 21322

---

ğŸ Script executed:

```shell
cat apps/frontend/src/shared/i18n/locales/en/navigation.json
```

Repository: AndyMik90/Auto-Claude

Length of output: 3262

---

ğŸ Script executed:

```shell
sed -n '110,165p' apps/frontend/src/renderer/components/Sidebar.tsx | grep -A 5 "useProjectEnv"
```

Repository: AndyMik90/Auto-Claude

Length of output: 47

---

ğŸ Script executed:

```shell
grep -B 5 -A 10 "useProjectEnvStore\|loadProjectEnvConfig" apps/frontend/src/renderer/components/Sidebar.tsx | head -40
```

Repository: AndyMik90/Auto-Claude

Length of output: 917

---

ğŸ Script executed:

```shell
sed -n '350,360p' apps/frontend/src/renderer/components/Sidebar.tsx
```

Repository: AndyMik90/Auto-Claude

Length of output: 384

---

ğŸ Script executed:

```shell
grep -n "appName\|Auto Claude" apps/frontend/src/shared/i18n/locales/en/*.json
```

Repository: AndyMik90/Auto-Claude

Length of output: 7108

---

ğŸ Script executed:

```shell
sed -n '126,176p' apps/frontend/src/renderer/components/Sidebar.tsx
```

Repository: AndyMik90/Auto-Claude

Length of output: 1550

---

ğŸ Script executed:

```shell
grep -n "useTranslation\|useProjectEnv" apps/frontend/src/renderer/components/Sidebar.tsx | head -20
```

Repository: AndyMik90/Auto-Claude

Length of output: 212

---



</details>

**Fix stale async responses and add i18n translation for app name.**

The `envConfig` can be overwritten by a slow IPC response from a previously selected project, causing nav items to reflect the wrong project state. Add a cancellation guard before setting state. Additionally, the hardcoded "Auto Claude" text at line 353 must use a translation key per i18n guidelines.

<details>
<summary>ğŸ› ï¸ Suggested fixes</summary>

**Race condition guard:**
```diff
  useEffect(() => {
+   let cancelled = false;
+   const projectId = selectedProject?.id;
+   const autoBuildPath = selectedProject?.autoBuildPath;
+
    const loadEnvConfig = async () => {
-     if (selectedProject?.autoBuildPath) {
+     if (!projectId || !autoBuildPath) {
+       setEnvConfig(null);
+       return;
+     }
      try {
-       const result = await window.electronAPI.getProjectEnv(selectedProject.id);
+       const result = await window.electronAPI.getProjectEnv(projectId);
-       if (result.success && result.data) {
+       if (!cancelled) {
+         setEnvConfig(result.success && result.data ? result.data : null);
+       }
-         setEnvConfig(result.data);
-       } else {
-         setEnvConfig(null);
-       }
      } catch {
+       if (!cancelled) {
          setEnvConfig(null);
+       }
      }
    };
    loadEnvConfig();
+   return () => {
+     cancelled = true;
+   };
-  }, [selectedProject?.id, selectedProject?.autoBuildPath]);
+  }, [selectedProject?.id, selectedProject?.autoBuildPath]);
```

**App name translation (line 353):**
```diff
- <span className="electron-no-drag text-lg font-bold text-primary">Auto Claude</span>
+ <span className="electron-no-drag text-lg font-bold text-primary">{t('appName', { ns: 'common' })}</span>
```
Add `"appName": "Auto Claude"` to `en/common.json` and `fr/common.json`.

</details>

<details>
<summary>ğŸ¤– Prompt for AI Agents</summary>

```
In `@apps/frontend/src/renderer/components/Sidebar.tsx` around lines 126 - 175,
The IPC response for getProjectEnv can arrive after the user switches projects
and overwrite envConfig; in the useEffect that defines loadEnvConfig (which
calls window.electronAPI.getProjectEnv and calls setEnvConfig), add a
cancellation guard (e.g., an isMounted/isCancelled flag or abort token) so you
only call setEnvConfig when the response corresponds to the current effect
invocation; ensure you clear the flag in the cleanup to avoid stale updates.
Also replace the hardcoded "Auto Claude" string with an i18n key (e.g., use
t('common:appName') via your translation hook) and add "appName": "Auto Claude"
to en/common.json and fr/common.json so the UI uses the translated app name.
```

</details>

<!-- fingerprinting:phantom:medusa:eagle -->

<!-- This is an auto-generated comment by CodeRabbit -->

âœ… Addressed in commits 54d4a4c to 528df3a

---

## Suggested Fix

```typescript
**App name translation (line 353):**
```

---

## Implementation Notes

*Status: RESOLVED*

**Resolution:** Body contains resolution marker

**Resolved At:** 2026-01-28T15:40:46.490304

