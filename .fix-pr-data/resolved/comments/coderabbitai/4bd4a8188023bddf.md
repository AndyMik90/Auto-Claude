# Comment: 4bd4a8188023bddf

**Source:** coderabbitai
**Type:** comment
**File:** `apps/backend/agents/linear_resolution_agent.py`
**Original ID:** 2735948277
**Created:** None
**Severity:** LOW
**Status:** RESOLVED

---

## Original Content

_ðŸ§¹ Nitpick_ | _ðŸ”µ Trivial_

**Code duplication with `linear_similarity_agent.py`.**

Both `_format_labels` and `_fetch_linear_ticket` are near-duplicates of functions in `linear_similarity_agent.py` (see relevant snippets). Consider extracting these to a shared utility module to maintain DRY principles.


<details>
<summary>Suggested approach</summary>

Create a shared module like `apps/backend/agents/linear_utils.py`:

```python
# linear_utils.py
from typing import Any
import httpx
import logging

logger = logging.getLogger(__name__)

def format_labels(labels_obj: dict[str, Any]) -> str:
    """Format labels object to string."""
    if not labels_obj or "nodes" not in labels_obj:
        return "None"
    labels = [node.get("name", "") for node in labels_obj.get("nodes", [])]
    return ", ".join(labels) if labels else "None"

async def fetch_linear_ticket(ticket_id: str, api_key: str) -> dict[str, Any] | None:
    """Fetch a single Linear ticket by ID."""
    # ... shared implementation
```

Then import from this shared module in both agents.
</details>


Also applies to: 328-357

<details>
<summary>ðŸ¤– Prompt for AI Agents</summary>

```
In `@apps/backend/agents/linear_resolution_agent.py` around lines 211 - 217,
Duplicate helper logic exists in _format_labels and _fetch_linear_ticket across
linear_resolution_agent.py and linear_similarity_agent.py; extract these into a
shared utility module (e.g., apps/backend/agents/linear_utils.py) exposing
format_labels and fetch_linear_ticket (or similarly named functions), move the
implementation there (including any HTTP/async handling and logging used by
_fetch_linear_ticket), then update both agents to import and call the shared
functions instead of their local versions to remove duplication.
```

</details>

<!-- fingerprinting:phantom:poseidon:ocelot -->

<!-- This is an auto-generated comment by CodeRabbit -->

âœ… Addressed in commit 6ed72f8

---

## Implementation Notes

*Status: RESOLVED*

**Resolution:** Body contains resolution marker

**Resolved At:** 2026-01-28T15:41:11.466161

