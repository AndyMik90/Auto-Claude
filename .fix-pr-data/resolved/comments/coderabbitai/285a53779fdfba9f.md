# Comment: 285a53779fdfba9f

**Source:** coderabbitai
**Type:** comment
**File:** `apps/frontend/src/renderer/components/linear/hooks/useLinearTickets.ts`
**Original ID:** 2713898515
**Created:** None
**Severity:** HIGH
**Status:** SKIPPED

---

## Original Content

_üßπ Nitpick_ | _üîµ Trivial_

**Consider cleanup on projectId change effect.**

When `projectId` changes rapidly (e.g., user quickly switches projects), the previous async operations may still be in flight. Consider adding cleanup or aborting pending operations.

<details>
<summary>Suggested improvement</summary>

```diff
 useEffect(() => {
+  // Abort any pending ticket fetch when project changes
+  currentFetchTicketIdRef.current = null;
   hasLoadedRef.current = false;
   setHasMore(true);
   useLinearStore.getState().clearTickets();
   useLinearStore.getState().clearValidationResults();
   useLinearStore.getState().selectTicket(null);
-  currentFetchTicketIdRef.current = null;
 }, [projectId]);
```
</details>

<!-- suggestion_start -->

<details>
<summary>üìù Committable suggestion</summary>

> ‚ÄºÔ∏è **IMPORTANT**
> Carefully review the code before committing. Ensure that it accurately replaces the highlighted code, contains no missing lines, and has no issues with indentation. Thoroughly test & benchmark the code to ensure it meets the requirements.

```suggestion
  useEffect(() => {
    // Abort any pending ticket fetch when project changes
    currentFetchTicketIdRef.current = null;
    hasLoadedRef.current = false;
    setHasMore(true);
    useLinearStore.getState().clearTickets();
    useLinearStore.getState().clearValidationResults();
    useLinearStore.getState().selectTicket(null);
  }, [projectId]);
```

</details>

<!-- suggestion_end -->

<details>
<summary>ü§ñ Prompt for AI Agents</summary>

```
In `@apps/frontend/src/renderer/components/linear/hooks/useLinearTickets.ts`
around lines 169 - 176, The effect that resets state on projectId change (the
useEffect block that sets hasLoadedRef.current, setHasMore, calls
useLinearStore.getState().clearTickets(), clearValidationResults(),
selectTicket(null), and resets currentFetchTicketIdRef.current) must also cancel
or ignore any in-flight async work; add a cleanup that either calls
AbortController.abort() for any ongoing fetches used by the hook or toggles a
cancelled flag/fetchId so callbacks (e.g., ticket fetch handlers and any
functions that use currentFetchTicketIdRef) early-return when cancelled, and
ensure any created AbortController or cancelled flag is stored (e.g., in a ref)
and aborted/marked in the effect's return to prevent processing stale results
when projectId changes rapidly.
```

</details>

<!-- fingerprinting:phantom:medusa:ocelot -->

<!-- This is an auto-generated comment by CodeRabbit -->

---

## Suggested Fix

```typescript
</details>

<!-- suggestion_end -->

<details>
<summary>ü§ñ Prompt for AI Agents</summary>
```

---

## Implementation Notes

*Status: SKIPPED*

**Resolution:** Trivial nitpick - code quality suggestion, not blocking bug