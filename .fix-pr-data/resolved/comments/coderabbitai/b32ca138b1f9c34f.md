# Comment: b32ca138b1f9c34f

**Source:** coderabbitai
**Type:** comment
**File:** `apps/backend/tests/integration/test_linear_mcp.py`
**Original ID:** 2713898422
**Created:** None
**Severity:** CRITICAL
**Status:** SKIPPED

---

## Original Content

_âš ï¸ Potential issue_ | _ğŸ”´ Critical_

<details>
<summary>ğŸ§© Analysis chain</summary>

ğŸ Script executed:

```shell
rg -n -A 15 "def _get_cache_key" apps/backend/agents/linear_validator.py
```

Repository: AndyMik90/Auto-Claude

Length of output: 678

---

ğŸ Script executed:

```shell
sed -n '364,410p' apps/backend/agents/linear_validator.py
```

Repository: AndyMik90/Auto-Claude

Length of output: 1829

---



</details>

**Test assertion expects incorrect cache key format.**

The test at line 223 expects `_get_cache_key("LIN-123", "2024-01-18T10:00:00Z")` to return `"LIN-123:2024-01-18T10:00:00Z"`, but the actual implementation sanitizes colons in the timestamp portion. The method replaces all colons with underscores in the `validation_timestamp` parameter (line 393-395), so the function will return `"LIN-123:2024-01-18T10_00_00Z"`. Update the assertion to match the actual implementation:

```
assert key1 == "LIN-123:2024-01-18T10_00_00Z"
```

Apply the same fix to line 226 (key2 assertion) and line 230 (key3 assertion).

<details>
<summary>ğŸ¤– Prompt for AI Agents</summary>

```
In `@apps/backend/tests/integration/test_linear_mcp.py` around lines 206 - 231,
The test assertions expect colons in the timestamp but the agent's
_get_cache_key sanitizes colons to underscores in the validation_timestamp, so
update the expected values for key1, key2 and key3 to match the implementation
(e.g., "LIN-123:2024-01-18T10_00_00Z" instead of "LIN-123:2024-01-18T10:00:00Z")
so that assertions against agent._get_cache_key(...) reflect the
colon-to-underscore substitution performed by _get_cache_key.
```

</details>

<!-- fingerprinting:phantom:medusa:ocelot -->

<!-- This is an auto-generated comment by CodeRabbit -->

---

## Implementation Notes

*Status: SKIPPED*

**Resolution:** Test assertion already expects sanitized timestamp format (line 223 shows correct format)