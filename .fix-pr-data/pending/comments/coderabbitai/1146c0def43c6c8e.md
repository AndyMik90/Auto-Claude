# Comment: 1146c0def43c6c8e

**Source:** coderabbitai
**Type:** comment
**File:** `apps/backend/tests/test_linear_validation_runner.py`
**Line:** 30
**Original ID:** 2738348110
**Created:** None
**Severity:** MEDIUM
**Status:** PENDING

---

## Original Content

_âš ï¸ Potential issue_ | _ğŸŸ¡ Minor_

**Test doesnâ€™t verify `linear_utils` behavior.**

Right now this only re-evaluates the local string logic, so it would still pass if `fetch_linear_ticket` changes and builds headers incorrectly. Assert against the implementation instead.


<details>
<summary>âœ… Suggested fix</summary>

```diff
-        from agents.linear_utils import fetch_linear_ticket
-
-        # Test the authorization pattern from linear_utils.py
-        api_key = "test_token"
-        expected = api_key if api_key.startswith("lin_api_") else f"Bearer {api_key}"
-
-        assert expected == "Bearer test_token"
-
-        # Test with lin_api_ prefix
-        api_key = "lin_api_12345"
-        expected = api_key if api_key.startswith("lin_api_") else f"Bearer {api_key}"
-
-        assert expected == "lin_api_12345"
+        source_file = Path(__file__).parent.parent / "agents" / "linear_utils.py"
+        content = source_file.read_text(encoding="utf-8")
+
+        # Check for the authorization pattern
+        assert 'startswith("lin_api_")' in content
+        assert 'f"Bearer {api_key}"' in content
```
</details>

<details>
<summary>ğŸ¤– Prompt for AI Agents</summary>

```
In `@apps/backend/tests/test_linear_validation_runner.py` around lines 16 - 30,
The test currently only recomputes the expected header string instead of
validating linear_utils behavior; update the test to call fetch_linear_ticket
(from agents.linear_utils) and assert the Authorization header it produces: for
api_key "test_token" expect "Bearer test_token", and for "lin_api_12345" expect
"lin_api_12345". Locate the test method test_linear_utils_authorization_pattern
and replace the local string-only assertions with calls to fetch_linear_ticket
(or the specific helper in linear_utils that builds headers) and assert against
the returned headers/dict keys like "Authorization".
```

</details>

<!-- fingerprinting:phantom:poseidon:eagle -->

<!-- This is an auto-generated comment by CodeRabbit -->

---

## Suggested Fix

```python
</details>

<details>
<summary>ğŸ¤– Prompt for AI Agents</summary>
```

---

## Implementation Notes

*Status: PENDING - Not yet verified or implemented*

### Verification Checklist

- [ ] Read file at comment location
- [ ] Verify if issue is already fixed
- [ ] Implement fix if needed
- [ ] Re-verify after implementation

