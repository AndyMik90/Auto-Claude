# Comment: 3232ab05b187d5c3

**Source:** coderabbitai
**Type:** comment
**File:** `apps/backend/agents/linear_resolution_agent.py`
**Line:** 308
**Original ID:** 2735948281
**Created:** None
**Severity:** HIGH
**Status:** PENDING

---

## Original Content

_‚ö†Ô∏è Potential issue_ | _üü† Major_

**Model fallback duplicated; should use phase_config helper consistently.**

The hardcoded model fallback `"claude-3-5-sonnet-20241022"` is repeated in both `create_client()` and `LinearResolutionAgent()`. This should use the centralized `get_phase_model()` helper per coding guidelines.


<details>
<summary>Proposed fix</summary>

```diff
+from phase_config import get_phase_model
+
 async def check_tickets_resolution(
     project_dir: str,
     ticket_ids: list[str],
     lookback_days: int = 90,
     model: str | None = None,
 ) -> dict[str, Any]:
     # ...
+    resolved_model = model or get_phase_model("linear_resolution")
+
     # Create client and run analysis
     client = create_client(
         project_dir=project_dir,
         spec_dir=None,
-        model=model or "claude-3-5-sonnet-20241022",
+        model=resolved_model,
         agent_type="linear_resolution",
     )
 
-    agent = LinearResolutionAgent(model=model or "claude-3-5-sonnet-20241022")
+    agent = LinearResolutionAgent(model=resolved_model)
```
</details>

Based on coding guidelines: "Resolve model and thinking level from user settings via `get_phase_model()` and `get_phase_thinking_budget()` from `phase_config.py` helpers".

<details>
<summary>ü§ñ Prompt for AI Agents</summary>

```
In `@apps/backend/agents/linear_resolution_agent.py` around lines 310 - 318, The
model fallback is hardcoded in two places; replace the duplicated literal with
the centralized helper by calling get_phase_model() and using its return for
both create_client(...) and LinearResolutionAgent(...). Locate the create_client
invocation and the LinearResolutionAgent constructor and pass
model=get_phase_model() (or model=model or get_phase_model() if optionally
provided) so both call sites use the same resolved model from
phase_config.get_phase_model; also import get_phase_model at top if not already
imported.
```

</details>

<!-- fingerprinting:phantom:poseidon:ocelot -->

<!-- This is an auto-generated comment by CodeRabbit -->

---

## Suggested Fix

```python
</details>

Based on coding guidelines: "Resolve model and thinking level from user settings via `get_phase_model()` and `get_phase_thinking_budget()` from `phase_config.py` helpers".

<details>
<summary>ü§ñ Prompt for AI Agents</summary>
```

---

## Implementation Notes

*Status: PENDING - Not yet verified or implemented*

### Verification Checklist

- [ ] Read file at comment location
- [ ] Verify if issue is already fixed
- [ ] Implement fix if needed
- [ ] Re-verify after implementation

