# Review: 4679913fac4b2847

**Source:** coderabbitai
**Type:** review
**Original ID:** 3718832803
**Created:** None
**Severity:** MEDIUM
**Status:** SKIPPED

---

## Original Content

**Actionable comments posted: 4**

<details>
<summary>ðŸ¤– Fix all issues with AI agents</summary>

```
In `@apps/backend/tests/test_linear_similarity_agent.py`:
- Around line 52-60: Replace the realistic-looking token "lin_api_1234567890" in
the test that calls _fetch_team_tickets with an obviously fake sentinel value
(e.g., "lin_api_FAKE_TOKEN" or "lin_api_TEST") to avoid secret-scan false
positives; update the call to _fetch_team_tickets("test-team-id",
api_key="lin_api_FAKE_TOKEN") and keep the subsequent header assertions
(headers["Authorization"] == "lin_api_FAKE_TOKEN" and not
headers["Authorization"].startswith("Bearer ")) unchanged so the test behavior
remains the same while preventing CI gitleaks matches.
- Around line 545-563: The inline comment inside
test_parse_response_handles_errors_array contradicts the test name/docstring;
update that comment to state the expected behavior (e.g., "Should return an
empty list when GraphQL errors array is present") so it matches the
test/test_parse_response_handles_errors_array docstring and the behavior of
_fetch_team_tickets.
- Around line 379-391: The test temporarily unsets LINEAR_API_KEY but only
restores it when original_key is truthy, so an original empty string would not
be restored; update the restore logic in the test that uses original_key (the
block around LinearValidationAgent and the finally) to check "original_key is
not None" instead of a truthy check so that an empty-string environment value is
correctly restored after the test.

In `@apps/backend/tests/test_linear_validation_runner.py`:
- Around line 16-30: The test currently only recomputes the expected header
string instead of validating linear_utils behavior; update the test to call
fetch_linear_ticket (from agents.linear_utils) and assert the Authorization
header it produces: for api_key "test_token" expect "Bearer test_token", and for
"lin_api_12345" expect "lin_api_12345". Locate the test method
test_linear_utils_authorization_pattern and replace the local string-only
assertions with calls to fetch_linear_ticket (or the specific helper in
linear_utils that builds headers) and assert against the returned headers/dict
keys like "Authorization".
```

</details>

<!-- This is an auto-generated comment by CodeRabbit for review status -->

---

## Implementation Notes

*Status: SKIPPED*

**Reason:** Review state: COMMENTED

