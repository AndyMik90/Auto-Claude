# Comment: f3d347a08fe1524a

**Source:** sentry
**Type:** comment
**File:** `apps/backend/agents/linear_utils.py`
**Original ID:** 2737822156
**Created:** None
**Severity:** HIGH
**Status:** RESOLVED

---

## Original Content

**Bug:** The `async` function `fetch_linear_ticket` uses the synchronous `requests.post()`, which will block the asyncio event loop when awaited.
<sub>Severity: HIGH</sub>
<!-- BUG_PREDICTION -->

<details>
<summary><b title="Reference ID: `9345974`">Suggested Fix</b></summary>

Replace the synchronous `requests.post()` call with an asynchronous equivalent from a library like `httpx` or `aiohttp`. This will ensure the HTTP request is non-blocking and integrates correctly with the asyncio event loop.
</details>

<details open>
<summary><b title="Reference ID: `9345974`">Prompt for AI Agent</b></summary>

```
Review the code at the location below. A potential bug has been identified by an AI
agent.
Verify if this is a real issue. If it is, propose a fix; if not, explain why it's not
valid.

Location: apps/backend/agents/linear_utils.py#L65-L71

Potential issue: The `fetch_linear_ticket` function is declared as `async` and is
awaited in multiple agents, such as `LinearResolutionAgent` and `LinearSimilarityAgent`.
However, its implementation uses the synchronous `requests.post()` method with a
30-second timeout. When this function is called, it will block the entire asyncio event
loop for the duration of the HTTP request, preventing any other concurrent tasks from
executing. This will cause the application to become unresponsive during Linear API
operations, with the blocking time multiplying if multiple tickets are processed.
```
</details>

<!--
<sub>Reference ID: `9345974`</sub>-->

---

## Suggested Fix

```python
Review the code at the location below. A potential bug has been identified by an AI
agent.
Verify if this is a real issue. If it is, propose a fix; if not, explain why it's not
valid.

Location: apps/backend/agents/linear_utils.py#L65-L71

Potential issue: The `fetch_linear_ticket` function is declared as `async` and is
awaited in multiple agents, such as `LinearResolutionAgent` and `LinearSimilarityAgent`.
However, its implementation uses the synchronous `requests.post()` method with a
30-second timeout. When this function is called, it will block the entire asyncio event
loop for the duration of the HTTP request, preventing any other concurrent tasks from
executing. This will cause the application to become unresponsive during Linear API
operations, with the blocking time multiplying if multiple tickets are processed.
```

---

## Implementation Notes

*Status: RESOLVED*

**Resolution:** Fixed in commit 82a5f1f6: Wrapped requests.post() in asyncio.to_thread()

### Fix Commit

`82a5f1f6`